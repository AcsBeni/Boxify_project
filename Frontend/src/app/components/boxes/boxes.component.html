<p-card class="boxes-card">

  <!-- ===== HEADER ===== -->
  <div class="boxes-header">
    <h3>Boxes</h3>

    <span class="p-input-icon-left">
      <i class="pi pi-search"></i>
      <input
        pInputText
        placeholder="Search by code or location"
        [(ngModel)]="searchTerm" />
    </span>
  </div>
  <p-button label="Új doboz hozzáadása"  icon="pi pi-plus" routerLink="/boxes/new" />
  <!-- ===== TABLE ===== -->
  <p-table
    [value]="filteredBoxes"
    dataKey="id"
    selectionMode="single"
    (onRowSelect)="openBox($event.data)"
    responsiveLayout="scroll">

    <ng-template pTemplate="header">
      <tr>
        <th>Kód</th>
        <th>Címke</th>
        <th>hosszúság,szélesség,magasság(cm)</th>
        <th>Max súly</th>
        <th>Státusz</th>
        <th>Hely</th>
        <th>Műveletek</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-box>
      <tr>
        <td>{{ box.code }}</td>
        <td>{{ box.labelType }}</td>
        <td>
          {{ box.lengthCm }} × {{ box.widthCm }} × {{ box.heightCm }}
        </td>
        <td>{{ box.maxWeightKg }} kg</td>
        <td>
          <span class="status" [ngClass]="box.status.toLowerCase()">
            {{ box.status }}
          </span>
        </td>
        <td>{{ box.location || '—' }}</td>
        <td>
          
            <p-button  icon="pi pi-trash" severity="danger" (onClick)="delete(box.id)"  />
             <p-button icon="pi pi-pencil" severity="warning" routerLink="/boxes/{{box.id}}" />

        </td>
      </tr>
    </ng-template>

  </p-table>
</p-card>

<!-- ===== MODAL ===== -->
<p-dialog
  [(visible)]="dialogVisible"
  [modal]="true"
  header="Box contents"
  [style]="{ width: '520px' }">

  <ng-container *ngIf="selectedBox">

    <h4>{{ selectedBox.code }}</h4>
    <p class="muted">
      {{ selectedBox.lengthCm }}×{{ selectedBox.widthCm }}×{{ selectedBox.heightCm }} cm ·
      Max {{ selectedBox.maxWeightKg }} kg
    </p>

    <p-table [value]="boxItems" size="small">
      <ng-template pTemplate="header">
        <tr>
          <th>Name</th>
          <th>Size (cm)</th>
          <th>Max Weight</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-item>
        <tr>
          <td>
            <strong>{{ item.name }}</strong>
            <div class="item-desc" *ngIf="item.description">
              {{ item.description }}
            </div>
          </td>
          <td>
            {{ item.lengthCm }}×{{ item.widthCm }}×{{ item.heightCm }}
          </td>
          <td>{{ item.maxWeightKg }} kg</td>
        </tr>
      </ng-template>
    </p-table>

  </ng-container>
</p-dialog>